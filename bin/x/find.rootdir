#!/bin/sh
#
# find rootdir where $args[0] is located
#
# find.rootdir .git [<end_of_search>]

# generated by ChatGPT
# prompt: write posix compliant shell script to find root directory that contains Makefile

if [ -z "$2" ]; then
    end_of_search="/"
else
    if [ -d "$2" ]; then
        end_of_search="$2"
    else
        echo "Error: $2 is not a directory"
        exit 1
    fi
fi

# Start from the current directory
current_dir="$PWD"

# Iterate until reaching the root directory "/"
while [ "$current_dir" != "$end_of_search" ]; do
    # Check if Makefile exists in the current directory
    if [ -f "$current_dir/$1" ]; then
        echo "$current_dir"
        exit 0
    fi

    # Move one directory up
    current_dir=$(dirname "$current_dir")
done

exit 1
