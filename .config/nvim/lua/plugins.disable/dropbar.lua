
local nvim_set_hl = vim.api.nvim_set_hl
nvim_set_hl(0, "DropBarIconCurrentContext", { link = "StatusLine" })
nvim_set_hl(0, "DropBarCurrentContext", { link = "StatusLine" })
nvim_set_hl(0, "DropBarFzfMatch", { link = "StatusLine" })
nvim_set_hl(0, "DropBarHover", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconCurrentContext", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindArray", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindBoolean", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindBreakStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindCall", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindCaseStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindClass", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindConstant", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindConstructor", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindContinueStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindDeclaration", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindDelete", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindDoStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindElseStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindEnum", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindEnumMember", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindEvent", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindField", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindFile", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindFolder", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindForStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindFunction", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindH1Marker", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindH2Marker", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindH3Marker", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindH4Marker", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindH5Marker", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindH6Marker", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindIdentifier", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindIfStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindInterface", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindKeyword", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindList", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindMacro", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindMarkdownH1", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindMarkdownH2", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindMarkdownH3", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindMarkdownH4", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindMarkdownH5", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindMarkdownH6", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindMethod", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindModule", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindNamespace", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindNull", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindNumber", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindObject", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindOperator", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindPackage", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindPair", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindProperty", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindReference", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindRepeat", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindScope", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindSpecifier", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindString", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindStruct", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindSwitchStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindTerminal", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindType", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindTypeParameter", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindUnit", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindValue", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindVariable", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconKindWhileStatement", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconUIIndicator", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconUIPickPivot", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconUISeparator", { link = "StatusLine" })
nvim_set_hl(0, "DropBarIconUISeparatorMenu", { link = "StatusLine" })
nvim_set_hl(0, "DropBarMenuCurrentContext", { link = "StatusLine" })
nvim_set_hl(0, "DropBarMenuFloatBorder", { link = "StatusLine" })
nvim_set_hl(0, "DropBarMenuHoverEntry", { link = "StatusLine" })
nvim_set_hl(0, "DropBarMenuHoverIcon", { link = "StatusLine" })
nvim_set_hl(0, "DropBarMenuHoverSymbol", { link = "StatusLine" })
nvim_set_hl(0, "DropBarMenuNormalFloat", { link = "StatusLine" })
nvim_set_hl(0, "DropBarMenuSbar", { link = "StatusLine" })
nvim_set_hl(0, "DropBarMenuThumb", { link = "StatusLine" })
nvim_set_hl(0, "DropBarPreview", { link = "StatusLine" })
nvim_set_hl(0, "User1", { link = "WarningMsg" })


vim.cmd.packadd("dropbar.nvim")
vim.cmd.packadd("nvim-web-devicons")
require("dropbar").setup({
	general = { enable = false },
	icons = {
		enable = false,
        bar = {
            hover = false,
        },
        menu = {
            preview = false,
            quick_navigation = false,
        },
		kinds = {
			use_devicons = true,
			symbols = {
				Array = "  ",
				Boolean = "  ",
				BreakStatement = "  ",
				Call = "  ",
				CaseStatement = "  ",
				Class = "  ",
				Color = "  ",
				Constant = "  ",
				Constructor = "  ",
				ContinueStatement = "  ",
				Copilot = "  ",
				Declaration = "  ",
				Delete = "  ",
				DoStatement = "  ",
				Enum = "  ",
				EnumMember = "  ",
				Event = "  ",
				Field = "  ",
				File = "  ",
				Folder = "  ",
				ForStatement = "  ",
				Function = "  ",
				H1Marker = "  ", -- Used by markdown treesitter parser
				H2Marker = "  ",
				H3Marker = "  ",
				H4Marker = "  ",
				H5Marker = "  ",
				H6Marker = "  ",
				Identifier = "  ",
				IfStatement = "  ",
				Interface = "  ",
				Keyword = "  ",
				List = "  ",
				Log = "  ",
				Lsp = "  ",
				Macro = "  ",
				MarkdownH1 = "  ", -- Used by builtin markdown source
				MarkdownH2 = "  ",
				MarkdownH3 = "  ",
				MarkdownH4 = "  ",
				MarkdownH5 = "  ",
				MarkdownH6 = "  ",
				Method = "  ",
				Module = "  ",
				Namespace = "  ",
				Null = "  ",
				Number = "  ",
				Object = "  ",
				Operator = "  ",
				Package = "  ",
				Pair = "  ",
				Property = "  ",
				Reference = "  ",
				Regex = "  ",
				Repeat = "  ",
				Scope = "  ",
				Snippet = "  ",
				Specifier = "  ",
				Statement = "  ",
				String = "  ",
				Struct = "  ",
				SwitchStatement = "  ",
				Terminal = "  ",
				Text = "  ",
				Type = "  ",
				TypeParameter = "  ",
				Unit = "  ",
				Value = "  ",
				Variable = "  ",
				WhileStatement = "  ",
			},
		},
	},
	sources = {
		treesitter = {
			valid_types = {
				"array",
				"boolean",
				"break_statement",
				"call",
				"case_statement",
				"class",
				"constant",
				"constructor",
				"continue_statement",
				"delete",
				"do_statement",
				"enum",
				"enum_member",
				"event",
				"for_statement",
				"function",
				"h1_marker",
				"h2_marker",
				"h3_marker",
				"h4_marker",
				"h5_marker",
				"h6_marker",
				"if_statement",
				"interface",
				"keyword",
				"list",
				"macro",
				"method",
				"module",
				"namespace",
				"null",
				-- "number",
				"operator",
				"package",
				"pair",
				"property",
				"reference",
				"repeat",
				"scope",
				"specifier",
				-- "string",
				"struct",
				"switch_statement",
				"type",
				"type_parameter",
				"unit",
				"value",
				"variable",
				"while_statement",
				"declaration",
				"field",
				"identifier",
				"object",
				"statement",
				"text",
			},
		},
	},
	bar = {
		sources = function(buf, _)
			local sources = require("dropbar.sources")
			local utils = require("dropbar.utils")
			local ft = vim.bo[buf].ft
			if vim.bo[buf].buftype == "terminal" then
				return {
					-- sources.terminal,
				}
			elseif vim.treesitter.language.get_lang(ft) == nil then
				return {
					sources.path,
				}
			end
			return {
				-- sources.path,
				utils.source.fallback({
					sources.treesitter,
					sources.lsp,
					sources.markdown,
				}),
			}
		end,
		padding = {
			left = 0,
			right = 0,
		},
		-- pick = {
		--   pivots = 'abcdefghijklmnopqrstuvwxyz',
		-- },
		truncate = true,
	},
})
-- vim.o.winbar = "%=%t %{%v:lua.dropbar.get_dropbar_str()%}"

-- vim.o.tabline = "%=%t %{%v:lua.dropbar.get_dropbar_str()%}"
-- vim.o.statusline = "%t%{%v:lua.dropbar.get_dropbar_str()%}"
vim.o.statusline = "%1*%t %{%v:lua.dropbar.get_dropbar_str()%}%=%l/%L"
-- restore with %0*
-- -- vim.opt.winbar = ""
